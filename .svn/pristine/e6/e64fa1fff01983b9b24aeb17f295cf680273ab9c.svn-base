using System.Security.Cryptography.X509Certificates;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEditor;

public class LightManager : MonoBehaviour
{
     static LightManager m_instance;
    public GameObject[] Lights;
    public PlayerMovement player;
    public Dictionary<string,Enemy> enemies=new Dictionary<string, Enemy>();

    public static LightManager Instance { get => m_instance; set => m_instance = value; }

    private void Start()
    {
        m_instance=this;
        StartCoroutine(CloseLight());
    }
    IEnumerator CloseLight()
    {
        while (player.IsLiving)
        {
            foreach (var light in Lights)
            {
                light.SetActive(false);
            }
            yield return new WaitForSeconds(3);
            foreach (var enemy in enemies.Values)
            {
                if (enemy.IsDie)
                {
                    Debug.Log("revival "+enemy.name);
                    enemy.gameObject.SetActive(true);
                    enemy.Revival();
                    //enemies.Remove(enemy);
                }
            }
            yield return new WaitForSeconds(12);
            foreach (var light in Lights)
            {
                light.SetActive(true);
            }
            yield return new WaitForSeconds(10);
        }
    }
}
